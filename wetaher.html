<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .weather-icon {
            filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.1));
        }
    </style>
</head>
<body class="flex items-center justify-center p-4">
    <div class="glass rounded-3xl p-8 max-w-md w-full shadow-2xl">
        <h1 class="text-4xl font-bold text-white text-center mb-8">Weather App</h1>
        
        <div class="mb-6">
            <div class="relative">
                <input 
                    type="text" 
                    id="cityInput" 
                    placeholder="Masukkan nama kota..."
                    class="w-full px-6 py-4 rounded-full bg-white bg-opacity-20 text-white placeholder-white placeholder-opacity-70 focus:outline-none focus:ring-2 focus:ring-white focus:ring-opacity-50 transition"
                />
                <button 
                    id="searchBtn"
                    class="absolute right-2 top-2 bg-white bg-opacity-30 hover:bg-opacity-40 text-white px-6 py-2 rounded-full transition">
                    Cari
                </button>
            </div>
        </div>

        <div id="weatherInfo" class="hidden">
            <div class="text-center mb-6">
                <h2 id="cityName" class="text-3xl font-bold text-white mb-2"></h2>
                <p id="date" class="text-white text-opacity-80"></p>
            </div>

            <div class="flex justify-center items-center mb-6">
                <img id="weatherIcon" src="" alt="Weather Icon" class="w-32 h-32 weather-icon">
            </div>

            <div class="text-center mb-6">
                <div class="text-6xl font-bold text-white mb-2" id="temperature"></div>
                <div class="text-2xl text-white text-opacity-90 capitalize" id="description"></div>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div class="glass rounded-2xl p-4 text-center">
                    <div class="text-white text-opacity-70 text-sm mb-1">Kelembaban</div>
                    <div class="text-2xl font-bold text-white" id="humidity"></div>
                </div>
                <div class="glass rounded-2xl p-4 text-center">
                    <div class="text-white text-opacity-70 text-sm mb-1">Kecepatan Angin</div>
                    <div class="text-2xl font-bold text-white" id="windSpeed"></div>
                </div>
                <div class="glass rounded-2xl p-4 text-center">
                    <div class="text-white text-opacity-70 text-sm mb-1">Terasa Seperti</div>
                    <div class="text-2xl font-bold text-white" id="feelsLike"></div>
                </div>
                <div class="glass rounded-2xl p-4 text-center">
                    <div class="text-white text-opacity-70 text-sm mb-1">Tekanan</div>
                    <div class="text-2xl font-bold text-white" id="pressure"></div>
                </div>
            </div>
        </div>

        <div id="loading" class="hidden text-center">
            <div class="inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-white"></div>
            <p class="text-white mt-4">Memuat data cuaca...</p>
        </div>

        <div id="error" class="hidden text-center text-white bg-red-500 bg-opacity-30 rounded-2xl p-4 mt-4">
            <p id="errorMessage"></p>
        </div>
    </div>

    <script>
        const cityInput = document.getElementById('cityInput');
        const searchBtn = document.getElementById('searchBtn');
        const weatherInfo = document.getElementById('weatherInfo');
        const loading = document.getElementById('loading');
        const error = document.getElementById('error');

        async function getWeather(city) {
            try {
                loading.classList.remove('hidden');
                weatherInfo.classList.add('hidden');
                error.classList.add('hidden');

                console.log('Mencari cuaca untuk:', city);

                const response = await fetch(
                    `https://wttr.in/${encodeURIComponent(city)}?format=j1`
                );

                console.log('Response status:', response.status);

                if (!response.ok) {
                    throw new Error('Kota tidak ditemukan. Coba nama kota lain.');
                }

                const data = await response.json();
                console.log('Data cuaca:', data);
                displayWeather(data, city);
            } catch (err) {
                console.error('Error:', err);
                showError(err.message || 'Terjadi kesalahan. Pastikan koneksi internet Anda aktif.');
            } finally {
                loading.classList.add('hidden');
            }
        }

        function displayWeather(data, cityName) {
            const current = data.current_condition[0];
            const location = data.nearest_area[0];
            
            document.getElementById('cityName').textContent = `${location.areaName[0].value}, ${location.country[0].value}`;
            document.getElementById('date').textContent = new Date().toLocaleDateString('id-ID', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            document.getElementById('temperature').textContent = `${current.temp_C}°C`;
            document.getElementById('description').textContent = current.weatherDesc[0].value;
            
            // Set weather icon based on weather code
            const weatherCode = current.weatherCode;
            const iconMap = {
                '113': '01d', '116': '02d', '119': '03d', '122': '04d',
                '143': '50d', '176': '10d', '179': '13d', '182': '13d',
                '185': '13d', '200': '11d', '227': '13d', '230': '13d',
                '248': '50d', '260': '50d', '263': '09d', '266': '09d',
                '281': '13d', '284': '13d', '293': '10d', '296': '10d',
                '299': '10d', '302': '10d', '305': '10d', '308': '10d',
                '311': '13d', '314': '13d', '317': '13d', '320': '13d',
                '323': '13d', '326': '13d', '329': '13d', '332': '13d',
                '335': '13d', '338': '13d', '350': '13d', '353': '09d',
                '356': '10d', '359': '10d', '362': '13d', '365': '13d',
                '368': '13d', '371': '13d', '374': '13d', '377': '13d',
                '386': '11d', '389': '11d', '392': '11d', '395': '13d'
            };
            
            const iconCode = iconMap[weatherCode] || '01d';
            document.getElementById('weatherIcon').src = `https://openweathermap.org/img/wn/${iconCode}@4x.png`;
            
            document.getElementById('humidity').textContent = `${current.humidity}%`;
            document.getElementById('windSpeed').textContent = `${current.windspeedKmph} km/h`;
            document.getElementById('feelsLike').textContent = `${current.FeelsLikeC}°C`;
            document.getElementById('pressure').textContent = `${current.pressure} mb`;

            weatherInfo.classList.remove('hidden');
            console.log('Tampilan cuaca berhasil ditampilkan');
        }

        function showError(message) {
            document.getElementById('errorMessage').textContent = message;
            error.classList.remove('hidden');
        }

        searchBtn.addEventListener('click', () => {
            const city = cityInput.value.trim();
            console.log('Tombol cari diklik, kota:', city);
            if (city) {
                getWeather(city);
            } else {
                showError('Silakan masukkan nama kota terlebih dahulu');
            }
        });

        cityInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const city = cityInput.value.trim();
                console.log('Enter ditekan, kota:', city);
                if (city) {
                    getWeather(city);
                } else {
                    showError('Silakan masukkan nama kota terlebih dahulu');
                }
            }
        });

        // Load default city
        console.log('Memuat cuaca Jakarta...');
        getWeather('Jakarta');
    </script>
</body>
</html>